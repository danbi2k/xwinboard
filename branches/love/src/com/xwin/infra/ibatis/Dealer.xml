<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE sqlMap
	PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN"
	"http://ibatis.apache.org/dtd/sql-map-2.dtd">
	
<sqlMap namespace="Dealer">

	<typeAlias alias="Dealer" type="com.xwin.domain.user.Dealer" />
	
	<resultMap id="dealerResultMap" class="Dealer">
		<result property="id" column="ID"/>
		<result property="dealerId" column="DEALERID"/>
		<result property="password" column="PASSWORD"/>
		<result property="preFeeRate" column="PRE_FEE_RATE"/>
		<result property="postFeeRate" column="POST_FEE_RATE"/>
		<result property="nickName" column="NICKNAME"/>
		<result property="mobile" column="MOBILE"/>
		<result property="email" column="EMAIL"/>
		<result property="status" column="STATUS"/>
		<result property="joinDate" column="JOIN_DATE"/>
		<result property="bankName" column="BANKNAME"/>
		<result property="bankNumber" column="BANKNUMBER"/>
		<result property="bankOwner" column="BANKOWNER"/>
		<result property="note" column="NOTE"/>
	</resultMap>
	
	<insert id="insertDealer" parameterClass="Dealer">
		INSERT INTO tbl_dealer(DEALERID, PASSWORD, NICKNAME, MOBILE, EMAIL, STATUS, JOIN_DATE, BANKNAME, BANKNUMBER, BANKOWNER)
			VALUES(#dealerId#, #password#, #nickName#, #mobile#, #email#, #status#, #joinDate#, #bankName#, #bankNumber#, #bankOwner#)
	</insert>
	
	<update id="updateDealer" parameterClass="Dealer">
		UPDATE tbl_dealer
		<dynamic prepend="SET">
			<isNotNull prepend="," property="password">
				PASSWORD = #password#
			</isNotNull>
			<isNotNull prepend="," property="nickName">
				NICKNAME = #nickName#
			</isNotNull>	
			<isNotNull prepend="," property="mobile">	
				MOBILE = #mobile#
			</isNotNull>	
			<isNotNull prepend="," property="email">
				EMAIL = #email#
			</isNotNull>	
			<isNotNull prepend="," property="status">
				STATUS = #status#
			</isNotNull>
			<isNotNull prepend="," property="bankName">
				BANKNAME = #bankName#
			</isNotNull>
			<isNotNull prepend="," property="bankNumber">
				BANKNUMBER = #bankNumber#
			</isNotNull>
			<isNotNull prepend="," property="bankOwner">
				BANKOWNER = #bankOwner#
			</isNotNull>
			<isNotNull prepend="," property="note">
				NOTE = #note#
			</isNotNull>
		</dynamic>
		WHERE DEALERID = #dealerId#			
	</update>
	
	<delete id="deleteDealer" parameterClass="java.lang.String">
		DELETE FROM tbl_dealer WHERE ID = #value#
	</delete>
	
	<select id="selectDealer" resultMap="dealerResultMap"
		parameterClass="map">
		SELECT * FROM tbl_dealer
		<dynamic prepend="WHERE">
			<isNotNull prepend="AND" property="dealerId">
				DEALERID = #dealerId#
			</isNotNull>
			<isNotNull prepend="AND" property="nickName">
				NICKNAME = #nickName#
			</isNotNull>
			<isNotNull prepend="AND" property="status">
				STATUS = #status#
			</isNotNull>
			<isNotNull prepend="AND" property="mobile">
				MOBILE = #mobile#
			</isNotNull>
		</dynamic>
	</select>
	
	<select id="selectDealerList" resultMap="dealerResultMap"
		parameterClass="map">
		SELECT * FROM tbl_dealer
		<dynamic prepend="WHERE">
			<isNotNull prepend="AND" property="dealerId">
				DEALERID = #dealerId#
			</isNotNull>
			<isNotNull prepend="AND" property="status">
				STATUS = #status#
			</isNotNull>
			<isNotNull prepend="AND" property="nickName">
				NICKNAME LIKE #nickName#
			</isNotNull>			
			<isNotNull prepend="AND" property="mobile">
				MOBILE LIKE #mobile#
			</isNotNull>			
			<isNotNull prepend="AND" property="email">
				EMAIL LIKE #email#
			</isNotNull>
			<isNotNull property="orderCol">
				ORDER BY $orderCol$ $orderBy$
			</isNotNull>
			<isNotNull prepend="" property="fromRow">
				LIMIT #fromRow#, #rowSize#
			</isNotNull>
		</dynamic>
	</select>
	
	<select id="selectDealerCount" resultClass="integer"
		parameterClass="map">
		SELECT COUNT(*) FROM tbl_dealer
		<dynamic prepend="WHERE">
			<isNotNull prepend="AND" property="dealerId">
				DEALERID = #dealerId#
			</isNotNull>
			<isNotNull prepend="AND" property="status">
				STATUS = #status#
			</isNotNull>
			<isNotNull prepend="AND" property="nickName">
				NICKNAME LIKE #nickName#
			</isNotNull>			
			<isNotNull prepend="AND" property="mobile">
				MOBILE LIKE #mobile#
			</isNotNull>			
			<isNotNull prepend="AND" property="email">
				EMAIL LIKE #email#
			</isNotNull>
		</dynamic>
	</select>
	
	<update id="updateDealerStatus" parameterClass="map">
		UPDATE tbl_dealer
		SET STATUS = #status#
		WHERE DEALERID = #dealerId#
	</update>
</sqlMap>
